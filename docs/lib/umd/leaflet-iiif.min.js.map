{"version":3,"sources":["webpack://leaflet-iiif/webpack/universalModuleDefinition","webpack://leaflet-iiif/./src/event.ts","webpack://leaflet-iiif/./src/layer.ts","webpack://leaflet-iiif/./node_modules/tslib/tslib.es6.js","webpack://leaflet-iiif/external {\"amd\":\"leaflet\",\"root\":\"L\",\"commonjs\":\"leaflet\",\"commonjs2\":\"leaflet\"}","webpack://leaflet-iiif/./src/types.ts","webpack://leaflet-iiif/./src/utils/server-capabilities.ts","webpack://leaflet-iiif/./src/utils/helper.ts","webpack://leaflet-iiif/./src/utils/projection.ts","webpack://leaflet-iiif/./src/toolbar.ts","webpack://leaflet-iiif/webpack/bootstrap","webpack://leaflet-iiif/webpack/runtime/define property getters","webpack://leaflet-iiif/webpack/runtime/hasOwnProperty shorthand","webpack://leaflet-iiif/webpack/runtime/make namespace object","webpack://leaflet-iiif/./src/index.ts"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE__4__","IIIF_EVENTS","CHANGE_FORMAT","CHANGE_QUALITY","CHANGE_ROTATION","CHANGE_MIRRORING","IIIFLayer","TileLayer","url","options","super","map","_url","server","SERVER_CAPABILITIES_DEFAULT","height","width","zoomLayers","setUrl","templateUrl","initializePromise","Promise","resolve","reject","fetch","then","response","json","data","computeServerCapabilities","Util","setOptions","Object","assign","DEFAULT_OPTIONS","tileSize","tileFormat","formats","quality","qualities","includes","minZoom","maxZoom","catch","e","computeZoomLayers","onAdd","fitBounds","getBounds","setMaxBounds","registerEvents","onRemove","unRegisterEvents","coords","z","x","y","zoomLayer","find","layer","zoom","Error","unprojectedSquare","projectSquare","rotation","bottomLeft","topRight","tileSizeX","scale","tileSizeY","minX","Math","min","minY","maxX","maxY","mirroring","diffX","params","format","region","abs","size","s","ceil","template","join","isValid","originalZoomLayer","tiles","result","latLngBounds","projectedSquare","sw","unproject","point","ne","pow","push","setMaxZoom","length","setMinZoom","on","onTileLoadStyle","changeFormat","value","changeQuality","changeRotation","changeMirroring","off","redraw","tile","naturalWidth","naturalHeight","style","top","right","left","bottom","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","constructor","prototype","create","__assign","t","i","n","arguments","call","apply","__rest","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","next","rejected","done","__generator","body","f","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","__createBinding","o","m","k","k2","undefined","__exportStar","__values","__read","ar","error","__spread","concat","__spreadArrays","il","a","j","jl","__await","__asyncGenerator","asyncIterator","q","resume","fulfill","settle","shift","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__importStar","mod","__esModule","default","__importDefault","__classPrivateFieldGet","receiver","privateMap","has","get","__classPrivateFieldSet","set","version","zoomOffset","DEFAULT_CONTROL_OPTIONS","enabled","title","html","computeServerCapabilitiesForV1","capabilities","match","profile","tile_width","tile_height","scale_factors","log2","uri","supports","scaleFactors","computeServerCapabilitiesForV2","extraFormats","filter","ef","extraQualities","eq","extraFeatures","computeServerCapabilitiesForV3","replace","projectPoint","rotationInRadian","PI","round","cos","sin","square","p1","p2","max","CONTROL_NAME","IIIFControl","Control","_container","DomUtil","container","getContainer","values","createActions","className","innerHTML","fn","fire","rotations","Number","parseInt","createButton","actions","actionsWrapper","dataset","opened","actionsList","forEach","action","li","appendChild","link","DomEvent","stopPropagation","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","enumerable","obj","prop","toStringTag","window","L","Event","tileLayer","control"],"mappings":"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","file":"leaflet-iiif.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"leaflet\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"leaflet\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"leaflet-iiif\"] = factory(require(\"leaflet\"));\n\telse\n\t\troot[\"leaflet-iiif\"] = factory(root[\"L\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE__4__) {\nreturn ","export const IIIF_EVENTS: { [event: string]: string } = {\n  CHANGE_FORMAT: \"iiif:format\",\n  CHANGE_QUALITY: \"iiif:quality\",\n  CHANGE_ROTATION: \"iiif:rotation\",\n  CHANGE_MIRRORING: \"iiif:mirroring\",\n};\n","import L, { Map, TileLayer, TileEvent } from \"leaflet\";\nimport { DEFAULT_OPTIONS, SERVER_CAPABILITIES_DEFAULT, IIIFLayerOptions, ServerCapabilities } from \"./types\";\nimport { IIIF_EVENTS } from \"./event\";\nimport { computeServerCapabilities } from \"./utils/server-capabilities\";\nimport { templateUrl } from \"./utils/helper\";\nimport { projectSquare } from \"./utils/projection\";\n\nexport class IIIFLayer extends TileLayer {\n  // Layer options (initialized by super)\n  public options!: IIIFLayerOptions;\n\n  // Leaflet map\n  map: Map | null = null;\n  _url = \"\";\n\n  // Promise of the call to the IIIF server to initialize the layer\n  // (initialized by the call to initialize that is done internally per leaflet)\n  initializePromise!: Promise<void>;\n\n  // Server capabilities\n  server: ServerCapabilities = SERVER_CAPABILITIES_DEFAULT;\n\n  // Dimension of the image\n  height = 0;\n  width = 0;\n\n  zoomLayers: Array<{\n    // Map zoom level\n    zoom: number;\n    // the scaling ratio\n    scale: number;\n    // height of the image at this scale\n    height: number;\n    // width of the image at this scale\n    width: number;\n    // number of tiles in x & y\n    tiles: [number, number];\n  }> = [];\n\n  /**\n   * IIIF Layer constructor.\n   *\n   * @param {string} url The IIIF info endpoint for an image  (ex: https://stacks.stanford.edu/image/iiif/hg676jb4964%2F0380_796-44/info.json)\n   * @param {object} options List of options for the layer\n   */\n  constructor(url: string, options: Partial<IIIFLayerOptions> = {}) {\n    super(url, options);\n    this.setUrl(templateUrl(url));\n  }\n\n  /**\n   * Initialize the layer by calling the info endpoint of the image,\n   * compute the server capabilities and set the initial state.\n   * @override\n   */\n  initialize(url: string, options: Partial<IIIFLayerOptions>): this {\n    this.initializePromise = new Promise((resolve, reject) => {\n      fetch(url)\n        .then(response => {\n          response\n            .json()\n            .then(data => {\n              // saving the image dimension\n              this.height = data.height;\n              this.width = data.width;\n\n              // server capabilities\n              this.server = computeServerCapabilities(data);\n\n              // Settings\n              this.options = L.Util.setOptions(\n                this,\n                Object.assign(\n                  {},\n                  DEFAULT_OPTIONS,\n                  // Server pref\n                  {\n                    tileSize: this.server.tileSize || DEFAULT_OPTIONS.tileSize,\n                    tileFormat: this.server.formats[0] || DEFAULT_OPTIONS.tileFormat,\n                    quality: this.server.qualities && this.server.qualities.includes(\"native\") ? \"native\" : \"default\",\n                    minZoom: this.server.minZoom || DEFAULT_OPTIONS.minZoom,\n                    maxZoom: this.server.maxZoom || DEFAULT_OPTIONS.maxZoom,\n                  },\n                  // User's options\n                  options,\n                ),\n              );\n              resolve();\n            })\n            .catch((e: Error) => reject(`Fail to fetch url ${url} : ${e}`));\n        })\n        .catch((e: Error) => reject(`Fail to fetch url ${url} : ${e}`));\n    });\n    return this;\n  }\n\n  onAdd(map: Map): this {\n    this.map = map;\n\n    // Wait for info.json fetch and parse to complete\n    this.initializePromise.then(() => {\n      // Compute image sizes\n      this.computeZoomLayers();\n\n      super.onAdd(map);\n\n      // Fit bounds\n      if (this.options.fitBounds) {\n        (this.map as Map).fitBounds(this.getBounds());\n      }\n\n      // Set max bound\n      if (this.options.setMaxBounds) {\n        (this.map as Map).setMaxBounds(this.getBounds());\n      }\n\n      // calling super after we compute all the zoom\n      // super.onAdd(map);\n    });\n\n    // register events\n    this.registerEvents(map);\n\n    return this;\n  }\n\n  onRemove(map: Map): this {\n    // calling super\n    super.onRemove(map);\n\n    // Remove maxBounds set for this image\n    if (this.options.setMaxBounds) {\n      // bug in the type definition\n      map.setMaxBounds((null as unknown) as L.LatLngBoundsExpression);\n    }\n\n    // unregister events\n    this.unRegisterEvents(map);\n\n    return this;\n  }\n\n  /**\n   * Generate the tile IIIF url based on the tile coordinates\n   */\n  public getTileUrl(coords: L.Coords): string {\n    const z = coords[\"z\"];\n    const x = coords[\"x\"];\n    const y = coords[\"y\"];\n    const zoomLayer = this.zoomLayers.find(layer => layer.zoom === z);\n    if (!zoomLayer) throw new Error(`Can't create tile for zoom ${z}`);\n\n    // Handle rotation\n    const unprojectedSquare = projectSquare(-1 * this.options.rotation, {\n      bottomLeft: { x, y },\n      topRight: { x: x + 1, y: y + 1 },\n    });\n\n    const tileSizeX = this.options.tileSize.x / zoomLayer.scale;\n    const tileSizeY = this.options.tileSize.y / zoomLayer.scale;\n\n    // Compute the image region / bbox NW/SE\n    let minX = Math.min(unprojectedSquare.bottomLeft.x * tileSizeX, this.width);\n    const minY = Math.min(unprojectedSquare.bottomLeft.y * tileSizeY, this.height);\n    let maxX = Math.min(minX + tileSizeX, this.width);\n    const maxY = Math.min(minY + tileSizeY, this.height);\n\n    // In mirroring, if we do the diff with the width,\n    // we then have the bbox NE/SO,\n    // so we need to switch back to NW/SE by add/subs the diff\n    if (this.options.mirroring === true) {\n      const diffX = maxX - minX;\n      minX = this.width - minX - diffX;\n      maxX = this.width - maxX + diffX;\n    }\n\n    const params = {\n      format: this.options.tileFormat,\n      quality: this.options.quality,\n      mirroring: this.options.mirroring,\n      region: [minX, minY, Math.abs(maxX - minX), Math.abs(maxY - minY)],\n      rotation: (360 - this.options.rotation) % 360,\n      size: [Math.abs(maxX - minX), Math.abs(maxY - minY)].map(s => Math.ceil(s * zoomLayer.scale)) as [number, number],\n    };\n\n    return L.Util.template(this._url, {\n      format: params.format,\n      quality: params.quality,\n      mirroring: params.mirroring ? \"!\" : \"\",\n      region: params.region.join(\",\"),\n      rotation: params.rotation,\n      size: params.size.join(\",\"),\n    });\n  }\n\n  protected _isValidTile(coords: L.Coords): boolean {\n    let isValid = false;\n    const x = coords[\"x\"];\n    const y = coords[\"y\"];\n    const z = coords[\"z\"];\n\n    // Handle rotation (leaflet axis are reversed, so a 90 rotation is in fact a -90 rotation)\n    const unprojectedSquare = projectSquare(-1 * this.options.rotation, {\n      bottomLeft: { x, y },\n      topRight: { x: x + 1, y: y + 1 },\n    });\n\n    if (this.options.minZoom <= z && z <= this.options.maxZoom) {\n      const originalZoomLayer = this.zoomLayers.find(layer => layer.zoom === z);\n      if (\n        originalZoomLayer &&\n        0 <= unprojectedSquare.bottomLeft.x &&\n        unprojectedSquare.bottomLeft.x < originalZoomLayer.tiles[0] &&\n        0 <= unprojectedSquare.bottomLeft.y &&\n        unprojectedSquare.bottomLeft.y < originalZoomLayer.tiles[1]\n      )\n        isValid = true;\n    }\n    return isValid;\n  }\n\n  /**\n   * Compute the bounds of the layer.\n   */\n  private getBounds(): L.LatLngBounds {\n    let result = L.latLngBounds([0, 1], [1, 0]);\n\n    const originalZoomLayer = this.zoomLayers.find(layer => layer.scale === 1);\n    if (this.map !== null && originalZoomLayer) {\n      const projectedSquare = projectSquare(this.options.rotation, {\n        bottomLeft: { x: 0, y: originalZoomLayer.height },\n        topRight: { x: originalZoomLayer.width, y: 0 },\n      });\n\n      const sw = this.map.unproject(L.point(projectedSquare.bottomLeft), 0);\n      const ne = this.map.unproject(L.point(projectedSquare.topRight), 0);\n      result = L.latLngBounds(sw, ne);\n    }\n\n    return result;\n  }\n\n  /**\n   * Compute the different images by zoom level\n   */\n  private computeZoomLayers(): void {\n    this.zoomLayers = [];\n\n    let zoom = this.options.minZoom;\n    while (zoom <= this.options.maxZoom) {\n      const scale = Math.pow(2, zoom);\n      const height = Math.ceil(this.height * scale);\n      const width = Math.ceil(this.width * scale);\n      this.zoomLayers.push({\n        zoom,\n        scale,\n        height,\n        width,\n        tiles: [Math.ceil(width / this.options.tileSize.x), Math.ceil(height / this.options.tileSize.y)],\n      });\n      zoom++;\n    }\n    // Setting the min /max zoom in the options & map\n    if (this.map !== null) {\n      this.map.setMaxZoom(this.zoomLayers[this.zoomLayers.length - 1].zoom);\n      this.map.setMinZoom(this.zoomLayers[0].zoom);\n    }\n  }\n\n  private registerEvents(map: Map): void {\n    this.on(\"tileload\", this.onTileLoadStyle);\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    map.on(IIIF_EVENTS.CHANGE_FORMAT, (e: any) => this.changeFormat(e.value));\n    map.on(IIIF_EVENTS.CHANGE_QUALITY, (e: any) => this.changeQuality(e.value));\n    map.on(IIIF_EVENTS.CHANGE_ROTATION, (e: any) => this.changeRotation(e.value));\n    map.on(IIIF_EVENTS.CHANGE_MIRRORING, (e: any) => this.changeMirroring(e.value));\n    /* eslint-enable @typescript-eslint/no-explicit-any */\n  }\n\n  private unRegisterEvents(map: Map): void {\n    this.off(\"tileload\", this.onTileLoadStyle);\n    /* eslint-disable @typescript-eslint/no-explicit-any */\n    map.off(IIIF_EVENTS.CHANGE_FORMAT, (e: any) => this.changeFormat(e.value));\n    map.off(IIIF_EVENTS.CHANGE_QUALITY, (e: any) => this.changeQuality(e.value));\n    map.off(IIIF_EVENTS.CHANGE_ROTATION, (e: any) => this.changeRotation(e.value));\n    map.off(IIIF_EVENTS.CHANGE_MIRRORING, (e: any) => this.changeMirroring(e.value));\n    /* eslint-enable @typescript-eslint/no-explicit-any */\n  }\n\n  private changeFormat(value: string): void {\n    this.options.tileFormat = value;\n    this.redraw();\n  }\n\n  private changeQuality(value: string): void {\n    this.options.quality = value;\n    this.redraw();\n  }\n\n  private changeRotation(value: number): void {\n    this.options.rotation = value;\n    // Set max bound\n    if (this.options.setMaxBounds && this.map !== null) {\n      this.map.setMaxBounds(this.getBounds());\n    }\n    this.redraw();\n  }\n\n  private changeMirroring(value: boolean): void {\n    this.options.mirroring = value;\n    this.redraw();\n  }\n\n  /**\n   * Handle border of images when the tiles are not full.\n   */\n  private onTileLoadStyle(tile: TileEvent): void {\n    if (tile.tile.naturalWidth !== this.options.tileSize.x || tile.tile.naturalHeight !== this.options.tileSize.y) {\n      tile.tile.style.width = `${tile.tile.naturalWidth}px`;\n      tile.tile.style.height = `${tile.tile.naturalHeight}px`;\n\n      const rotation = this.options.rotation % 360;\n      switch (rotation) {\n        case 90:\n          tile.tile.style.top = `${this.options.tileSize.x - tile.tile.naturalHeight}px`;\n          tile.tile.style.right = `${this.options.tileSize.y - tile.tile.naturalWidth}px`;\n          break;\n        case 180:\n          tile.tile.style.top = `${this.options.tileSize.x - tile.tile.naturalHeight}px`;\n          tile.tile.style.left = `${this.options.tileSize.y - tile.tile.naturalWidth}px`;\n          break;\n        case 270:\n          tile.tile.style.top = \"0\";\n          tile.tile.style.bottom = `${this.options.tileSize.x - tile.tile.naturalHeight}px`;\n          tile.tile.style.left = `${this.options.tileSize.y - tile.tile.naturalWidth}px`;\n          break;\n      }\n    }\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__4__;","import L, { ControlOptions, Point, TileLayerOptions } from \"leaflet\";\nimport { IIIFLayer } from \"./layer\";\nimport { IIIFControl } from \"./toolbar\";\n\n/**\n * List the capabilities of the server.\n */\nexport interface ServerCapabilities {\n  /**\n   * IIIF version of the server (1.1, 2.0 or 3.0)\n   */\n  version: string;\n  /**\n   * List of supported formats\n   */\n  formats: Array<string>;\n  /**\n   * List of supported qualities\n   */\n  qualities: Array<string>;\n  /**\n   * Support 90s rotation ?\n   * @default false\n   */\n  rotation: boolean;\n  /**\n   * Support mirroring ?\n   * @default false\n   */\n  mirroring: boolean;\n  /**\n   * Min zoom (related to Scale factors)\n   * @default 0\n   */\n  minZoom: number;\n  /**\n   * max zoom (related to Scale factors)\n   * @default 0\n   */\n  maxZoom: number;\n  /**\n   * Prefered tile size\n   */\n  tileSize: Point | null;\n}\n\n/**\n * Default values for server capabilties\n */\nexport const SERVER_CAPABILITIES_DEFAULT: ServerCapabilities = {\n  version: \"3.0\",\n  formats: [],\n  qualities: [],\n  rotation: false,\n  mirroring: false,\n  tileSize: null,\n  minZoom: -2,\n  maxZoom: 0,\n};\n\n/**\n * Settings for {@link IIIFLayer | IIIF layer}\n */\nexport interface IIIFLayerOptions extends TileLayerOptions {\n  /**\n   * Size of the tile (as a square)\n   * If not specified and the server has a preference, we take it, otherwise 256\n   * @default 256\n   */\n  tileSize: Point;\n  /**\n   * Format of the tiles (ie png, jpg, ...).\n   * @Default \"jpg\"\n   */\n  tileFormat: string;\n  /**\n   * Quality\n   * @default: \"default\"\n   */\n  quality: string;\n  /**\n   * Rotation (ex: 0, 90, 180, 270).\n   * @default 0\n   */\n  rotation: number;\n  /**\n   * Mirroring\n   * @default false\n   */\n  mirroring: boolean;\n  /**\n   * When initialiazed the layer, do you want to see the full picture ?\n   * @default true\n   */\n  fitBounds: boolean;\n  /**\n   * Does the user can pan outside the image ?\n   * @default false\n   */\n  setMaxBounds: boolean;\n  /**\n   * Min level zoom of the layer.\n   * @default 0\n   */\n  minZoom: number;\n  /**\n   * Max level zoom of the layer.\n   * @default 0\n   */\n  maxZoom: number;\n}\n\n/**\n * Default values for {@link IIIFLayerOptions}\n */\nexport const DEFAULT_OPTIONS: IIIFLayerOptions = {\n  tileSize: L.point(256, 256),\n  tileFormat: \"jpg\",\n  quality: \"default\",\n  rotation: 0,\n  mirroring: false,\n  fitBounds: true,\n  setMaxBounds: false,\n  minZoom: 0,\n  maxZoom: 0,\n  zoomOffset: 0,\n};\n\n/**\n * Configuration of an action on the control bar.\n * An action is an entry on the toolbal like, quality, format, ...\n */\ninterface IIIFControlAction {\n  /**\n   * Does the action is enabled ?\n   */\n  enabled: boolean;\n  /**\n   * Title of the action (used for title attribute in html)\n   */\n  title: string;\n  /**\n   * The html code to display the action entry in the toolbar.\n   */\n  html: string;\n  /**\n   * An optional list of possible values for this action.\n   * It's usefull for qualities, formats, ...\n   */\n  values?: Array<string>;\n}\n\n/**\n * Settings of {@link IIIFControl | IIIF control layer}\n */\nexport interface IIIFControlOptions extends ControlOptions {\n  quality: IIIFControlAction;\n  format: IIIFControlAction;\n  rotation: IIIFControlAction;\n  mirroring: IIIFControlAction;\n}\n\n/**\n * Default values for {@link IIIFControlOptions}\n */\nexport const DEFAULT_CONTROL_OPTIONS: IIIFControlOptions = {\n  quality: {\n    enabled: true,\n    title: \"Quality\",\n    html: `<span />`,\n  },\n  format: {\n    enabled: true,\n    title: \"Format\",\n    html: `<span />`,\n  },\n  rotation: {\n    enabled: true,\n    title: \"Rotation\",\n    html: `<span />`,\n  },\n  mirroring: {\n    enabled: true,\n    title: \"Mirroring\",\n    html: `<span />`,\n  },\n};\n\ndeclare global {\n  interface LeafletIIFWindow {\n    Iiif: { Event: unknown };\n    tileLayer: {\n      iiif: (url: string, options: IIIFLayerOptions) => IIIFLayer;\n    };\n    control: {\n      iiif: (layer: IIIFLayer, options: IIIFControlOptions) => IIIFControl;\n    };\n  }\n  interface Window {\n    L: LeafletIIFWindow;\n  }\n}\n","import L from \"leaflet\";\nimport { SERVER_CAPABILITIES_DEFAULT, ServerCapabilities } from \"../types\";\n\n/* eslint-disable  @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any */\n\n/**\n * Compute the server capabilities from the response of the info.\n */\nexport function computeServerCapabilities(data: any): ServerCapabilities {\n  let uri = `${data[\"@context\"]}`;\n\n  // in v3 it can be an array where the last item is the uri\n  if (data[\"@context\"] instanceof Array) {\n    uri = data[\"@context\"][data[\"@context\"].length - 1];\n  }\n\n  switch (uri) {\n    case \"http://library.stanford.edu/iiif/image-api/1.1/context.json\":\n      return computeServerCapabilitiesForV1(data);\n    case \"http://iiif.io/api/image/2/context.json\":\n      return computeServerCapabilitiesForV2(data);\n    case \"http://iiif.io/api/image/3/context.json\":\n    default:\n      return computeServerCapabilitiesForV3(data);\n  }\n}\n\n/**\n * Compute the server capabilities for a IIIF server in v1.1.\n * @see https://iiif.io/api/image/1.1/compliance/\n */\nexport function computeServerCapabilitiesForV1(data: any): ServerCapabilities {\n  const capabilities = Object.assign({}, SERVER_CAPABILITIES_DEFAULT);\n  capabilities.version = \"1.1\";\n\n  // Search the level compliance level\n  const match = `${data.profile}`.match(/^http:\\/\\/library.stanford.edu\\/iiif\\/image-api\\/1.1\\/compliance.html#(.*)$/);\n  const level = match && match.length === 2 ? match[1] : \"level0\";\n\n  // Defined capabilities per level\n  switch (level) {\n    case \"level2\":\n      capabilities.rotation = true;\n      capabilities.formats = [\"jpg\", \"png\"];\n      capabilities.qualities = [\"native\", \"color\", \"grey\", \"bitonial\"];\n      break;\n    case \"level1\":\n      capabilities.rotation = true;\n      capabilities.formats = [\"jpg\"];\n      capabilities.qualities = [\"native\"];\n      break;\n    // level0\n    default:\n      capabilities.rotation = false;\n      capabilities.formats = [\"jpg\"];\n      capabilities.qualities = [\"native\"];\n      break;\n  }\n  // Formats\n  if (data.formats) capabilities.formats = data.formats;\n\n  // Qualities\n  if (data.qualities) capabilities.qualities = data.qualities;\n\n  // Tiles size\n  if (data.tile_width)\n    capabilities.tileSize = L.point(data.tile_width, data.tile_height ? data.tile_height : data.tile_width);\n\n  // Scale factors\n  if (data.scale_factors && data.scale_factors.length > -1) {\n    capabilities.minZoom =\n      Math.log2(data.scale_factors[data.scale_factors.length - 1]) *\n      (data.scale_factors[data.scale_factors.length - 1] > 1 ? -1 : 1);\n    capabilities.maxZoom = Math.log2(data.scale_factors[0]) * (data.scale_factors[0] > 1 ? -1 : 1);\n  }\n\n  return capabilities;\n}\n\n/**\n * Compute the server capabilities for a IIIF server in v2.0.\n * @see https://iiif.io/api/image/2.0/#successful-responses\n */\nfunction computeServerCapabilitiesForV2(data: any): ServerCapabilities {\n  const capabilities = Object.assign({}, SERVER_CAPABILITIES_DEFAULT);\n  capabilities.version = \"2.0\";\n  const level = data.profile[0];\n\n  // Defined capabilities per level\n  switch (level) {\n    case \"level2\":\n      capabilities.qualities = [\"default\", \"bitonial\"];\n      capabilities.formats = [\"jpg\", \"png\"];\n      break;\n    case \"level1\":\n      capabilities.qualities = [\"default\"];\n      capabilities.formats = [\"jpg\", \"png\"];\n      break;\n    // level0\n    default:\n      capabilities.qualities = [\"default\"];\n      capabilities.formats = [\"jpg\"];\n      break;\n  }\n\n  // Formats\n  if (data.profile[1] && data.profile[1].formats) capabilities.formats = data.profile[1].formats;\n\n  // Qualities\n  if (data.profile[1] && data.profile[1].qualities) capabilities.qualities = data.profile[1].qualities;\n\n  // Rotation\n  if (\n    data.profile[1] &&\n    data.profile[1].supports &&\n    (data.profile[1].supports.includes(\"rotationBy90s\") || data.profile[1].supports.includes(\"rotationArbitrary\"))\n  )\n    capabilities.rotation = true;\n\n  // Mirroring\n  if (data.profile[1] && data.profile[1].supports && data.profile[1].supports.includes(\"mirroring\"))\n    capabilities.mirroring = true;\n\n  // Tiles size & scale factors\n  if (data.tiles && data.tiles.length > -1) {\n    const tile = data.tiles[0];\n    capabilities.tileSize = L.point(tile.width, tile.height ? tile.height : tile.width);\n    capabilities.minZoom =\n      Math.log2(tile.scaleFactors[tile.scaleFactors.length - 1]) *\n      (tile.scaleFactors[tile.scaleFactors.length - 1] > 1 ? -1 : 1);\n    capabilities.maxZoom = Math.log2(tile.scaleFactors[0]) * (tile.scaleFactors[0] > 1 ? -1 : 1);\n  }\n\n  return capabilities;\n}\n\n/**\n * Compute the server capabilities for a IIIF server in v3.0.\n * @see https://iiif.io/api/image/3.0/#51-image-information-request\n */\nfunction computeServerCapabilitiesForV3(data: any): ServerCapabilities {\n  const capabilities = Object.assign({}, SERVER_CAPABILITIES_DEFAULT);\n  capabilities.version = \"3.0\";\n\n  const level = data.profile;\n\n  // Defined capabilities per level\n  switch (level) {\n    case \"level2\":\n      capabilities.qualities = [\"default\"];\n      capabilities.formats = [\"jpg\", \"png\"];\n      break;\n    default:\n      capabilities.qualities = [\"default\"];\n      capabilities.formats = [\"jpg\"];\n      break;\n  }\n\n  // Extra format\n  if (data.extraFormats && data.extraFormats instanceof Array)\n    capabilities.formats = capabilities.formats.concat(\n      data.extraFormats.filter((ef: string) => !capabilities.formats.includes(ef)),\n    );\n\n  // Extra qualities\n  if (data.extraQualities && data.extraQualities instanceof Array)\n    capabilities.qualities = capabilities.qualities.concat(\n      data.extraQualities.filter((eq: string) => !capabilities.qualities.includes(eq)),\n    );\n\n  // Rotation\n  if (\n    data.extraFeatures &&\n    (data.extraFeatures.includes(\"rotationBy90s\") || data.extraFeatures.includes(\"rotationArbitrary\"))\n  )\n    capabilities.rotation = true;\n\n  // Mirroring\n  if (data.extraFeatures && data.extraFeatures.includes(\"mirroring\")) capabilities.mirroring = true;\n\n  // Tiles size\n  if (data.tiles && data.tiles.length > -1) {\n    const tile = data.tiles[0];\n    capabilities.tileSize = L.point(tile.width, tile.height ? tile.height : tile.width);\n    capabilities.minZoom =\n      Math.log2(tile.scaleFactors[tile.scaleFactors.length - 1]) *\n      (tile.scaleFactors[tile.scaleFactors.length - 1] > 1 ? -1 : 1);\n    capabilities.maxZoom = Math.log2(tile.scaleFactors[0]) * (tile.scaleFactors[0] > 1 ? -1 : 1);\n  }\n\n  return capabilities;\n}\n\n/* eslint-enable  @typescript-eslint/explicit-module-boundary-types, @typescript-eslint/no-explicit-any */\n","/**\n * Construct the tiles url template from the iiif image url\n */\nexport function templateUrl(url: string): string {\n  return url.replace(/info.json$/, \"{region}/{size}/{mirroring}{rotation}/{quality}.{format}\");\n}\n","export type Point = { x: number; y: number };\nexport type Square = { bottomLeft: Point; topRight: Point };\n\n/**\n * Rotation projection of a point around the origin 0,0.\n *\n * @param rotation The rotation in degree (ex: 90)\n * @param point The point to project\n * @returns The projected point for the specified rotation.\n */\nexport function projectPoint(rotation: number, point: Point): Point {\n  // negate to follow the direction 180-0\n  const rotationInRadian = (-1 * rotation * Math.PI) / 180;\n  return {\n    x: Math.round(point.x * Math.cos(rotationInRadian) - point.y * Math.sin(rotationInRadian)),\n    y: Math.round(point.y * Math.cos(rotationInRadian) + point.x * Math.sin(rotationInRadian)),\n  };\n}\n\n/**\n * Rotation projection of a square, around the origin 0,0.\n *\n * @param rotation The rotation in degree (ex: 90)\n * @param square The square to project\n * @returns The projected square for the specified rotation.\n */\nexport function projectSquare(rotation: number, square: Square): Square {\n  const p1 = projectPoint(rotation, square.bottomLeft);\n  const p2 = projectPoint(rotation, square.topRight);\n  const minX = Math.min(p1.x, p2.x);\n  const maxX = Math.max(p1.x, p2.x);\n  const minY = Math.min(p1.y, p2.y);\n  const maxY = Math.max(p1.y, p2.y);\n  return {\n    bottomLeft: { x: minX, y: minY },\n    topRight: { x: maxX, y: maxY },\n  };\n}\n","import L, { Control, Map } from \"leaflet\";\nimport { IIIFLayer } from \"./layer\";\nimport { IIIF_EVENTS } from \"./event\";\nimport { DEFAULT_CONTROL_OPTIONS, IIIFControlOptions } from \"./types\";\n\nconst CONTROL_NAME = \"leaflet-control-iiif\";\n\n/**\n * Control for the {@link IIIFLayer | IIIF layer}\n * Create a toolbar that allows you to control the layer's options.\n *\n * ```js\n * const control = new IIIFControl(layer, options);\n * control.addTo(map);\n * ```\n */\nexport class IIIFControl extends Control {\n  /**\n   * Options of the control (initialized by super)\n   */\n  public options!: IIIFControlOptions;\n\n  /**\n   * The IIIF layer on which the control takes affect\n   */\n  public layer: IIIFLayer;\n\n  /**\n   * The created html div container that will contains the toolbar\n   */\n  private _container: HTMLElement;\n\n  /**\n   * IIIF Control constructor.\n   *\n   * @param {object} options List of options for the control\n   */\n  constructor(layer: IIIFLayer, options: Partial<IIIFControlOptions> = {}) {\n    super(Object.assign({}, DEFAULT_CONTROL_OPTIONS, options));\n    this.layer = layer;\n    this._container = L.DomUtil.create(\"div\", `${CONTROL_NAME} leaflet-bar`);\n  }\n\n  /**\n   * Add the control to Leaflet map\n   */\n  onAdd(map: Map): HTMLElement {\n    const container = this.getContainer();\n    if (!container) throw new Error(\"Container for control is undefined\");\n    // Waiting the init of the layer\n    this.layer.initializePromise.then(() => {\n      // Qualities\n      if (this.options.quality.enabled === true) {\n        const qualities = this.options.quality.values ? this.options.quality.values : this.layer.server.qualities;\n        this.createActions(\n          this._container,\n          this.options.quality.title,\n          `${CONTROL_NAME}-quality`,\n          this.options.quality.html,\n          qualities.map((quality: string) => {\n            return {\n              title: quality,\n              className: `${CONTROL_NAME}-quality-${quality}`,\n              innerHTML: quality,\n              fn: () => {\n                map.fire(IIIF_EVENTS.CHANGE_QUALITY, { value: quality });\n              },\n            };\n          }),\n        );\n      }\n\n      // Formats\n      if (this.options.format.enabled === true) {\n        const formats = this.options.format.values ? this.options.format.values : this.layer.server.formats;\n        this.createActions(\n          container,\n          this.options.format.title,\n          `${CONTROL_NAME}-format`,\n          this.options.format.html,\n          formats.map((format: string) => {\n            return {\n              title: format,\n              className: `${CONTROL_NAME}-format-${format}`,\n              innerHTML: format,\n              fn: () => {\n                map.fire(IIIF_EVENTS.CHANGE_FORMAT, { value: format });\n              },\n            };\n          }),\n        );\n      }\n\n      // Formats\n      if (this.options.rotation.enabled === true && this.layer.server.rotation === true) {\n        const rotations = this.options.rotation.values ? this.options.rotation.values : [\"0\", \"90\", \"180\", \"270\"];\n        this.createActions(\n          container,\n          this.options.rotation.title,\n          `${CONTROL_NAME}-rotation`,\n          this.options.rotation.html,\n          rotations.map((rotation: string) => {\n            return {\n              title: rotation,\n              className: `${CONTROL_NAME}-rotation-${rotation}`,\n              innerHTML: rotation,\n              fn: () => {\n                map.fire(IIIF_EVENTS.CHANGE_ROTATION, { value: Number.parseInt(rotation) });\n              },\n            };\n          }),\n        );\n      }\n\n      // Mirroring\n      if (this.options.mirroring.enabled === true && this.layer.server.mirroring === true) {\n        this.createButton(\n          container,\n          this.options.mirroring.title,\n          `${CONTROL_NAME}-mirroring`,\n          this.options.mirroring.html,\n          () => {\n            map.fire(IIIF_EVENTS.CHANGE_MIRRORING, { value: !this.layer.options.mirroring });\n          },\n        );\n      }\n    });\n\n    return container;\n  }\n\n  /**\n   * Create a button\n   */\n  private createActions(\n    container: HTMLElement,\n    title: string,\n    className: string,\n    innerHTML: string,\n    actions: Array<{ title: string; className: string; innerHTML: string; fn: () => void }>,\n  ) {\n    const actionsWrapper = L.DomUtil.create(\"div\", className);\n    this.createButton(actionsWrapper, title, className, innerHTML, () => {\n      if (container.dataset.opened === className) container.dataset.opened = \"\";\n      else container.dataset.opened = className;\n    });\n\n    const actionsList = L.DomUtil.create(\"ul\", className);\n    actions.forEach(action => {\n      const li = L.DomUtil.create(\"li\", \"\", actionsList);\n      this.createButton(li, action.title, action.className, action.innerHTML, () => {\n        action.fn();\n        container.dataset.opened = \"\";\n      });\n      actionsList.appendChild(li);\n    });\n    actionsWrapper.appendChild(actionsList);\n\n    container.appendChild(actionsWrapper);\n  }\n\n  /**\n   * Create a button\n   */\n  private createButton(\n    container: HTMLElement,\n    title: string,\n    className: string,\n    innerHTML: string,\n    fn: () => void,\n  ): HTMLElement {\n    const link: HTMLElement = L.DomUtil.create(\"a\", className, container);\n    link.title = title;\n    link.innerHTML = innerHTML;\n    L.DomEvent.on(link, \"mousedown dblclick\", L.DomEvent.stopPropagation).on(link, \"click\", fn, this);\n    return link;\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { IIIFLayerOptions, IIIFControlOptions, ServerCapabilities } from \"./types\";\nimport { IIIF_EVENTS } from \"./event\";\nimport { IIIFLayer } from \"./layer\";\nimport { IIIFControl } from \"./toolbar\";\n\nexport { IIIFLayer, IIIFControl, IIIFLayerOptions, IIIFControlOptions, ServerCapabilities };\n\nwindow.L[\"Iiif\"] = { Event: IIIF_EVENTS };\n\nwindow.L.tileLayer[\"iiif\"] = function(url: string, options: IIIFLayerOptions) {\n  return new IIIFLayer(url, options);\n};\n\nwindow.L.control[\"iiif\"] = function(layer: IIIFLayer, options: IIIFControlOptions) {\n  return new IIIFControl(layer, options);\n};\n"],"sourceRoot":""}